class <%= class_name %>Migration < ActiveRecord::Migration
  def self.up
    create_table :<%= table_name %><%= ', :id => false' if fields.collect {|f| f['field']}.include?('id') %><%= ', :options => "%s"' % options if options %> do |t|
    <% for field in fields %>
      t.<%= field['type'] %> :<%= field['field'] %><%= ', :limit => %s' % field['size'] if field['size'] %><%= "\n" %>
    <% end %>
    end
    execute "ALTER TABLE <%= table_name %> ADD PRIMARY KEY (<%= primaries.collect {|p| "%s, " % p }.to_s.strip.chop %>)"
    <% if indexes.size > 1 %>
    add_index :<%= table_name %>, [<%= indexes.collect {|i| ":%s" % i }.join(", ") %>]
    <% elsif indexes.size == 1 %>
    add_index :<%= table_name %>, :<%= indexes[0] %><%= "\n" %>
    <% end %>
  end
  def self.down
    drop_table :<%= table_name %><%= "\n" %>
  end
end